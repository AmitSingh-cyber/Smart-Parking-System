<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Bookings</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background-color: #1e1e1e; color: #fff; padding: 20px; }
        .container { max-width: 1000px; margin: 0 auto; }
        h1 { border-bottom: 1px solid #333; padding-bottom: 10px; }
        .verify-box { background: #2d2d2d; padding: 20px; border-radius: 8px; margin-bottom: 20px; display: flex; gap: 10px; }
        input { padding: 10px; background: #333; border: 1px solid #555; color: white; border-radius: 4px; flex: 1; }
        button { padding: 10px 20px; background: #3b82f6; color: white; border: none; border-radius: 4px; cursor: pointer; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th { text-align: left; padding: 10px; background: #333; color: #aaa; }
        td { padding: 10px; border-bottom: 1px solid #333; }
        .status-active { color: #4ade80; font-weight: bold; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìã Active Bookings Verification</h1>
        
        <div class="verify-box">
            <input type="text" id="verify-input" placeholder="Enter Booking ID or Scan Barcode">
            <button onclick="verify()">Verify ID</button>
        </div>

        <table>
            <thead><tr><th>ID</th><th>Slot</th><th>Name</th><th>Car</th><th>Time</th><th>Status</th></tr></thead>
            <tbody id="booking-list"></tbody>
        </table>
    </div>

    <script>
        async function loadBookings() {
            const res = await fetch('/get_all_bookings');
            const data = await res.json();
            const tbody = document.getElementById('booking-list');
            tbody.innerHTML = '';
            data.forEach(b => {
                tbody.innerHTML += `<tr><td>${b.booking_id}</td><td>Slot ${b.slot_id}</td><td>${b.name}</td><td>${b.car}</td><td>${b.timestamp}</td><td class="status-active">${b.status}</td></tr>`;
            });
        }

        async function verify() {
            const id = document.getElementById('verify-input').value;
            if(!id) return alert("Enter ID");
            const res = await fetch('/verify_booking', {
                method:'POST', headers:{'Content-Type':'application/json'},
                body: JSON.stringify({booking_id: id})
            });
            const data = await res.json();
            if(data.success) {
                alert(`‚úÖ VALID BOOKING!\nUser: ${data.data.name}\nCar: ${data.data.car}\nSlot: ${data.data.slot_id}`);
            } else {
                alert("‚ùå INVALID ID");
            }
        }
        
        loadBookings();
        setInterval(loadBookings, 5000);
    </script>
</body>
</html>